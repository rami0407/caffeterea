<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ูุงุฆูุฉ ุงูุทุนุงู - ุจุฐูุฑ ุงููุนุฑูุฉ">
    <title>ุงููุงุฆูุฉ | ุจุฐูุฑ ุงููุนุฑูุฉ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&family=Heebo:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/student.css">
    <link rel="stylesheet" href="../css/feedback.css">
</head>

<body>
    <!-- Header -->
    <header class="app-header">
        <div class="header-right">
            <a href="../index.html" class="logo-mini">๐ฑ</a>
            <div style="display:flex; flex-direction:column;">
                <h1 class="header-title" data-i18n="menu" style="margin:0; font-size:1.2rem;">ุงููุงุฆูุฉ</h1>
                <span id="userNameDisplay"
                    style="font-size:0.85rem; color:var(--primary-dark); font-weight:bold;"></span>
            </div>
            <a href="../index.html" style="margin-right:15px; font-size:1.2rem; text-decoration:none;"
                title="ุงูุฑุฆูุณูุฉ">๐</a>
        </div>
        <div class="header-left">
            <!-- Wallet Balance -->
            <a href="wallet.html" class="wallet-badge">
                <span class="wallet-icon">๐ฐ</span>
                <span class="wallet-amount" id="balanceDisplay">0</span>
                <span class="wallet-label" data-i18n="coins">ููุทุฉ</span>
            </a>
            <!-- Cart -->
            <button class="cart-btn" id="cartBtn">
                <span class="cart-icon">๐</span>
                <span class="cart-count" id="cartCount">0</span>
            </button>
            <!-- Language -->
            <div class="lang-mini">
                <button class="lang-mini-btn" data-lang="ar">ุน</button>
                <button class="lang-mini-btn" data-lang="he">ืข</button>
            </div>
            <!-- Logout Button -->
            <button class="logout-btn" onclick="handleLogout()" title="ุชุณุฌูู ุงูุฎุฑูุฌ">
                <span>๐ช</span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <!-- Main Content -->
    <main class="main-content">

        <!-- Gamification Header (Challenge Modes) -->
        <section class="challenges-banner">
            <h3 class="challenges-title">โจ ุงุฎุชุฑ ููุจ ุงูุชุญุฏู ุงูููู:</h3>
            <div class="challenges-options">
                <button class="challenge-title-btn active" data-mode="cashier" onclick="setChallengeMode('cashier')">
                    <span class="icon">๐จโ๐ผ</span>
                    <div class="text">
                        <span class="title">ุงูุตุฑุงู ุงูุฐูู</span>
                        <span class="subtitle">ุงุญุณุจ ุงูุจุงูู</span>
                    </div>
                </button>

                <button class="challenge-title-btn" data-mode="nutrition" onclick="setChallengeMode('nutrition')">
                    <span class="icon">๐</span>
                    <div class="text">
                        <span class="title">ุฎุจูุฑ ุงูุชุบุฐูุฉ</span>
                        <span class="subtitle">ุงุฌูุน ุงูุณุนุฑุงุช</span>
                    </div>
                </button>

                <button class="challenge-title-btn" data-mode="discount" onclick="setChallengeMode('discount')">
                    <span class="icon">๐ท๏ธ</span>
                    <div class="text">
                        <span class="title">ุตุงุฆุฏ ุงูุฎุตููุงุช</span>
                        <span class="subtitle">ุงุญุณุจ ุงูุณุนุฑ</span>
                    </div>
                </button>
            </div>
        </section>

        <!-- Categories -->
        <nav class="categories-nav">
            <button class="category-btn active" data-category="all">
                <span class="category-icon">๐ฝ๏ธ</span>
                <span data-i18n="allItems">ุงููู</span>
            </button>
            <button class="category-btn" data-category="sandwiches">
                <span class="category-icon">๐ฅช</span>
                <span data-i18n="sandwiches">ุณูุฏููุดุงุช</span>
            </button>
            <button class="category-btn" data-category="drinks">
                <span class="category-icon">๐ฅค</span>
                <span data-i18n="drinks">ูุดุฑูุจุงุช</span>
            </button>
            <button class="category-btn" data-category="snacks">
                <span class="category-icon">๐ช</span>
                <span data-i18n="snacks">ูุฌุจุงุช ุฎูููุฉ</span>
            </button>
            <button class="category-btn" data-category="healthy">
                <span class="category-icon">๐ฅ</span>
                <span data-i18n="healthy">ุตุญู</span>
            </button>
        </nav>

        <!-- Products Grid -->
        <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here -->
            <div class="loading-state">
                <div class="spinner"></div>
                <p data-i18n="loading">ุฌุงุฑู ุงูุชุญููู...</p>
            </div>
        </div>
    </main>

    <!-- Cart Sidebar -->
    <div class="cart-overlay" id="cartOverlay"></div>
    <aside class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h2 data-i18n="cart">ุณูุฉ ุงูุทูุจุงุช</h2>
            <button class="close-cart-btn" id="closeCartBtn">โ</button>
        </div>

        <div class="cart-items" id="cartItems">
            <!-- Cart items will be loaded here -->
        </div>

        <div class="cart-empty hidden" id="cartEmpty">
            <span class="empty-icon">๐</span>
            <p data-i18n="emptyCart">ุงูุณูุฉ ูุงุฑุบุฉ</p>
        </div>

        <div class="cart-footer" id="cartFooter">
            <div class="cart-total">
                <span data-i18n="total">ุงููุฌููุน:</span>
                <span class="total-amount" id="cartTotal">0</span>
                <span data-i18n="coins">ููุทุฉ</span>
            </div>
            <button class="btn btn-primary btn-full" id="checkoutBtn">
                <span data-i18n="checkout">ุฅุชูุงู ุงูุทูุจ</span>
                <span class="btn-icon">โ</span>
            </button>
        </div>
    </aside>

    <!-- Order Success Modal -->
    <div class="modal-overlay hidden" id="successModal">
        <div class="modal-content success-modal">
            <div class="success-icon">โ</div>
            <h2 data-i18n="ecoTriggerTitle">ุชู ุงูุทูุจ ุจูุฌุงุญ!</h2>
            <div class="order-number-display">
                <span data-i18n="orderNumber">ุฑูู ุทูุจู:</span>
                <span class="order-num" id="orderNumberDisplay">--</span>
            </div>
            <p class="success-message" data-i18n="ecoTriggerMessage">ุณูุชู ุชุญุถูุฑ ุทูุจู ููุฑุงู. ุงูุชุธุฑ ุฑูู ุทูุจู ุนูู ุงูุดุงุดุฉ!
            </p>
            <button class="btn btn-primary" id="closeSuccessBtn">ุญุณูุงู</button>
        </div>
    </div>

    <!-- Waiting Message Modal -->
    <div class="modal-overlay hidden" id="waitingModal">
        <div class="modal-content waiting-modal">
            <div class="waiting-icon">โณ</div>
            <h2>ูุญู ูุนูู ุนูู ุทูุจู</h2>
            <p class="waiting-message">ุชุญูู ุจุงูุตุจุฑ ูุงุฐูุฑ ุงููู ูู ููุช ุงูุงูุชุธุงุฑ ๐คฒ</p>
            <div class="waiting-tips">
                <p class="tip-text">๐ ุดูุฑุงู ูุงุฎุชูุงุฑู ูุฌุจุฉ ุตุญูุฉ</p>
            </div>
            <button class="btn btn-primary" id="closeWaitingBtn">ุดูุฑุงู ๐</button>
        </div>
    </div>

    <!-- Math Challenge Modal -->
    <div class="modal-overlay hidden" id="mathChallengeModal">
        <div class="modal-content feedback-modal" style="text-align: center;">
            <div style="font-size: 3rem; margin-bottom: 15px;">๐งฎ</div>
            <h2>ุชุญุฏู ุงูุฑูุงุถูุงุช!</h2>
            <p style="margin-bottom: 20px; color: #64748b;">ุงุญุณุจ ูุฌููุน ููุงุท ูุดุชุฑูุงุชู ูุชุฃููุฏ ุงูุทูุจ</p>

            <div class="cart-summary-challenge" id="challengeItemsList"
                style="text-align: right; background: #f8fafc; padding: 15px; border-radius: 12px; margin-bottom: 20px; max-height: 200px; overflow-y: auto;">
                <!-- Items with prices will be listed here -->
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: bold;">ูู ุงููุฌููุนุ</label>
                <input type="number" id="studentMathAnswer" class="feedback-textarea"
                    style="height: 50px; text-align: center; font-size: 1.5rem;" placeholder="?">
            </div>

            <button class="btn btn-primary btn-full" id="verifyMathBtn">ุชุญูู ูุชุฃููุฏ ุงูุทูุจ</button>
            <button class="btn btn-secondary btn-full"
                style="margin-top: 10px; background: transparent; color: #64748b; border: 1px solid #cbd5e1;"
                onclick="closeMathModal()">ุนูุฏุฉ</button>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal-overlay hidden" id="feedbackModal">
        <div class="modal-content feedback-modal">
            <button class="close-feedback-btn" id="closeFeedbackBtn">โ</button>
            <h2>ููู ูุงูุช ุชุฌุฑุจุชูุ</h2>
            <p class="feedback-subtitle">ูุญู ููุชู ุจุฑุฃูู ๐</p>

            <div class="emoji-rating">
                <button class="emoji-btn" data-rating="excellent">๐</button>
                <button class="emoji-btn" data-rating="good">๐</button>
                <button class="emoji-btn" data-rating="neutral">๐</button>
                <button class="emoji-btn" data-rating="poor">๐</button>
            </div>

            <div class="feedback-input-group">
                <textarea id="feedbackText" class="feedback-textarea" placeholder="ุชููู ูุนูุง ููุง ุชุชููู ุนูููุง ๐ฌ"
                    rows="4"></textarea>
            </div>

            <button class="btn btn-primary btn-full" id="submitFeedbackBtn">ุฅุฑุณุงู ุงูุชูููู</button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="menu.html" class="nav-item active">
            <span class="nav-icon">๐ฝ๏ธ</span>
            <span data-i18n="menu">ุงููุงุฆูุฉ</span>
        </a>
        <a href="orders.html" class="nav-item">
            <span class="nav-icon">๐</span>
            <span data-i18n="orders">ุทูุจุงุชู</span>
        </a>
        <a href="wallet.html" class="nav-item">
            <span class="nav-icon">๐ฐ</span>
            <span data-i18n="wallet">ุงููุญูุธุฉ</span>
        </a>
        <a href="../index.html" class="nav-item">
            <span class="nav-icon">๐</span>
            <span data-i18n="home">ุงูุฑุฆูุณูุฉ</span>
        </a>
    </nav>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="../js/firebase-config.js?v=2.6"></script>
    <script src="../js/i18n.js?v=2.6"></script>
    <script src="../js/seed-data.js?v=2.6"></script>
    <script src="../js/student.js?v=2.8"></script>
</body>

</html>